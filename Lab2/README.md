# 075: Computer Architecture - Assignment 2

Ανδρέας Γούλας (9061), Κωνσταντίνος Δουμανίδης (9263)

## Βήμα 1ο

### L1 Instruction Cache

Παράμετρος     |Τιμή
---------------|------
Μέγεθος        |32768B
Συσχέτιση      |2-way
Μέγεθος Γραμμής|64B

### L1 Data Cache

Παράμετρος     |Τιμή
---------------|------
Μέγεθος        |65536B
Συσχέτιση      |2-way
Μέγεθος Γραμμής|64B

### L2 Cache

Παράμετρος     |Τιμή
---------------|--------
Μέγεθος        |2097152B
Συσχέτιση      |8-way
Μέγεθος Γραμμής|64B

### 2GHz

Benchmark|Χρόνος   |CPI      |L1 DCache|L1 ICache|L2 Cache
---------|---------|---------|---------|---------|--------
bzip     |83.982ms |1.679650 |0.014798 |0.000077 |0.282163
mcf      |64.955ms |1.299095 |0.002108 |0.023612 |0.055046
hmmer    |59.396ms |1.187917 |0.001637 |0.000221 |0.077760
sjeng    |513.528ms|10.270554|0.121831 |0.000020 |0.999972
libm     |174.671ms|3.493415 |0.060972 |0.000094 |0.999944

### 1GHz

Benchmark|Χρόνος   |CPI     |L1 DCache|L1 ICache|L2 Cache
---------|---------|--------|---------|---------|--------
bzip     |161.025ms|1.610247|0.014675 |0.000077 |0.282157
mcf      |127.942ms|1.279422|0.002108 |0.023627 |0.055046
hmmer    |118.530ms|1.185304|0.001629 |0.000221 |0.077747
sjeng    |704.056ms|7.040561|0.121831 |0.000020 |0.999972
libm     |262.327ms|2.623265|0.060971 |0.000094 |0.999944

Το mcf παρουσιάζει μεγάλο miss rate στην I-Cache, ενώ τα sjeng και libm στην L2
και D-Cache.

Το system χρονίζεται και στις δύο περιπτώσεις στα 1GHz (system.clk_domain). 
Αυτό το ρολόι χρησιμοποιείται για τον συγχρονισμό όλων των εξαρτημάτων πάνω
στην motherboard. Αντίθετα, το cpu_clk_domain αναφέρεται στο ρολόι του
επεξεργαστή, το οποίο είναι κατά κανόνα πολλαπλάσιο του system clock. Αν
προσθέσουμε επιπλέον επεξεργαστές, αυτοί θα χρονίζονται σε πολλαπλάσια του
system clock.

Παρατηρούμε ότι ο διπλασιασμός της συχνότητας του ρολογίου δεν έχει ως
αποτέλεσμα τον ακριβή υποδιπλασιασμό του χρόνο εκτέλεσης. Αυτό οφείλεται στο
γεγονός ότι μεγάλο μέρος του χρόνου εκτέλεσης δαπανάται σε προσβάσεις στην
μνήμη. Η επιτάχυνση είναι μικρότερη όταν έχουμε υψηλό miss rate.

### Graphs
![Execution Time](/Lab2/img/step1_exec_time.png)
![CPI](/Lab2/img/step1_CPI.png)
![D-Cache Miss Rate](/Lab2/img/step1_dcache.png)
![I-Cache Miss Rate](/Lab2/img/step1_icache.png)
![L2 Cache Miss Rate](/Lab2/img/step1_l2.png)

## Βήμα 2ο

Δοκιμάσαμε να μεταβάλλουμε τις παρακάτω παραμέτρους.

* ### Μέγεθος Γραμμής

Benchmark|32B      |64B      |128B    |256B
---------|---------|---------|--------|--------
bzip     |1.852581 |1.67965  |1.666573|1.661958
mcf      |1.260085 |1.299095 |1.330534|1.298444
hmmer    |1.196843 |1.187917 |1.181978|1.179864
sjeng    |17.653706|10.270554|6.799471|5.175719
libm     |5.607827 |3.493415 |2.581299|1.990648

Παρατηρούμε ότι το CPI εμφανίζει γενικά μια ισχυρή συσχέτιση με το μέγεθος
γραμμής της κρυφής μνήμης, ειδικά στα sjeng και libm. Αυτό οφείλεται στο γεγονός
ότι το miss rate της L1 D-Cache μειώνεται σημαντικά με την αύξηση του μεγέθους
γραμμής. Επίσης, συγκεκριμένα για τα bzip και hmmer παρατηρούμε μια σημαντική
μείωση στο miss rate της L2. To mcf δεν εμφάνισε κάποια βελτίωση με την αύξηση
της παραμέτρου.

Βέλτιστο: 256B

![Block Size](/Lab2/img/step2_block_size.png)
![D-Cache Miss Rate](/Lab2/img/step2_block_size_dc_rate.png)
![L2 Miss Rate](/Lab2/img/step2_block_size_l2_rate.png)

* ### L2

Benchmark|1MB 8-way|1MB 16-way|2MB 8-way|2MB 16-way|4MB 8-way|4MB 16-way
---------|---------|----------|---------|----------|---------|----------
bzip     |1.71052  |1.709114  |1.67965  |1.681276  |1.653848 |1.653276
mcf      |1.30375  |1.303708  |1.299095 |1.155591  |1.155043 |1.155043
hmmer    |1.187917 |1.187917  |1.187917 |1.187777  |1.187777 |1.187777
sjeng    |10.273271|10.270504 |10.270554|10.27089  |10.265417|10.264996
libm     |3.495444 |3.495444  |3.493415 |3.493415  |3.489639 |3.489639

Η μεταβολή των παραμέτρων της L2 cache είχε μια μικρή αλλά όχι σημαντική
επίδραση στο CPI. Η αύξηση του associativity σε 16-way είχε σχεδόν μηδενική
επίδραση.

Βέλτιστο: 4MB 8-way

* ### D-Cache

Benchmark|32KB 2-way|32KB 4-way|64KB 2-way|64KB 4-way|128KB 2-way|128KB 4-way
---------|----------|----------|----------|----------|-----------|----------
bzip     |1.706294  |1.693518  |1.67965   |1.663677  |1.650416   |1.64265
mcf      |1.29978   |1.299351  |1.299095  |1.298668  |1.298527   |1.298512
hmmer    |1.187917  |1.188545  |1.187917  |1.187732  |1.18617    |1.185883
sjeng    |10.27052  |10.270308 |10.270554 |10.27052  |10.27052   |10.270716
libm     |3.493825  |3.493415  |3.493415  |3.493415  |3.493415   |3.493415

Η μεταβολή των παραμέτρων της D-Cache είχε επίδραση μόνο στην απόδοση της bzip.
Η αυύξηση του associativity σε 4-way δεν βελτίωσε αισθητά την απόδοση.
Παρατηρούμε ότι όσο βελτιώνεται το miss rate της D-Cache, τόσο αυξάνεται το
miss rate στην L2 αλλά ταυτόχρονα οι προσβάσεις στην L2 γίνονται πιο σπάνιες.

Βέλτιστο: 64KB 4-way

![Miss Rate](/Lab2/img/step2_dcache_rate.png)

* ### I-Cache

Benchmark|16KB 2-way|16KB 4-way|32KB 2-way|32KB 4-way|64KB 2-way|64KB 4-way|128KB 2-way
---------|----------|----------|----------|----------|----------|----------|-----------
bzip     |1.680134  |1.680147  |1.67965   |1.679834  |1.679876  |1.679802  |1.679727
mcf      |1.402316  |1.32466   |1.299095  |1.15545   |1.155606  |1.155442  |1.155442
hmmer    |1.188644  |1.18806   |1.187917  |1.187777  |1.187711  |1.187649  |1.187649
sjeng    |10.270894 |10.270913 |10.270554 |10.270653 |10.270481 |10.270653 |10.270481
libm     |3.503812  |3.493588  |3.493415  |3.493293  |3.493415  |3.493293  |3.493293

Η μεταβολή των παραμέτρων της I-Cache επηρέασε σημαντικά μόνο την mcf. Αυτό
οφείλεται στο γεγονός ότι το benchmark περιέχει έναν βρόγχο επανάληψης ο οποίος
δε χωράει ολόκληρος στην default L1 I-Cache. Η αύξηση του associativity σε
4-way δεν είχε σημαντική επίδραση στην απόδοση.

Βέλτιστο: 64KB 2-way

![I-Cache](/Lab2/img/step2_mcf_icache.png)
![I-Cache Miss Rate](/Lab2/img/step2_mcf_icache_miss.png)
